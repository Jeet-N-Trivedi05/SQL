SET @RUN_DAY = '2025-02-10';
SET @MONEY_IN = 50000;


SELECT C.CLIENT_ID,C.CLIENT_NAME,C.FAIR_VALUE, 
SUM(F.NET_DAY_IN_AMOUNT) AS TOTAL_AMOUNT, F.TRANS_DATE
FROM CLIENT_MASTER_FAIR_VALUE C
JOIN FINAL_FIN_TRAN F
WHERE C.CLIENT_ID = F.CLIENT_ID 
AND TRANS_DATE = @RUN_DAY
AND TRANS_TYPE = 'IN'
GROUP BY C.CLIENT_ID
HAVING SUM(F.NET_DAY_IN_AMOUNT) >= C.FAIR_VALUE AND SUM(F.NET_DAY_IN_AMOUNT) >= @MONEY_IN ;



-- SET sql_mode = (SELECT REPLACE(@@sql_mode, 'ONLY_FULL_GROUP_BY', ''));
























