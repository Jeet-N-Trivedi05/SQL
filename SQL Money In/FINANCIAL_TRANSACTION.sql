CREATE TABLE FIN_TRAN 
(CLIENT_ID VARCHAR(10), AMOUNT INT(10), 
TRANS_TYPE VARCHAR(3), TRANS_DATE DATE)

INSERT INTO FIN_TRAN VALUES 
('S2343',100000,'IN', '2025-02-10'),
('S2343',10000,'OUT', '2025-02-10'),
('S2343',100000,'IN', '2025-02-10'),
('A4258',500000,'IN', '2025-02-10'),
('A4258',200000,'IN', '2025-02-10'),
('S2343',100000,'IN', '2025-02-11'),
('H8596',500000,'IN', '2025-02-10'),
('T3293',410000,'IN', '2025-02-10'),
('H8596',1200000,'IN', '2025-02-11');


SELECT * FROM FIN_TRAN;

CREATE TABLE FINAL_FIN_TRAN AS
	SELECT *, 
	(SUM(IF(TRANS_TYPE = 'IN',AMOUNT,0)) 
	- SUM(IF(TRANS_TYPE = 'OUT',AMOUNT,0))) AS NET_DAY_IN_AMOUNT 
	FROM FIN_TRAN
	GROUP BY CLIENT_ID,TRANS_DATE
	ORDER BY TRANS_DATE;
